{"version":3,"file":"interface.js","names":["PropTypes","optionsShape","config","object","isRequired","httpClient","oneOfType","func","loggingService","shape","logError","logInfo","serviceShape","sendTrackingLogEvent","identifyAuthenticatedUser","identifyAnonymousUser","sendTrackEvent","sendPageEvent","service","configure","AnalyticsService","options","checkPropTypes","eventName","properties","userId","traits","category","name","getAnalyticsService","Error","resetAnalyticsService"],"sources":["../../src/analytics/interface.js"],"sourcesContent":["/**\n * #### Import members from **@edx/frontend-platform/analytics**\n *\n * Contains a shared interface for tracking events.  Has a default implementation of\n * SegmentAnalyticsService, which supports Segment and the Tracking Log API (hosted in LMS).\n *\n * The `initialize` function performs much of the analytics configuration for you.  If, however,\n * you're not using the `initialize` function, analytics can be configured via:\n *\n * ```\n * import { configure, SegmentAnalyticsService } from '@edx/frontend-platform/analytics';\n * import { getConfig } from '@edx/frontend-platform';\n * import { getAuthenticatedHttpClient } from '@edx/frontend-platform/auth';\n * import { getLoggingService } from '@edx/frontend-platform/logging';\n *\n * configure(SegmentAnalyticsService, {\n *   config: getConfig(),\n *   loggingService: getLoggingService(),\n *   httpClient: getAuthenticatedHttpClient(),\n * });\n * ```\n *\n * As shown in this example, analytics depends on the configuration document, logging, and having\n * an authenticated HTTP client.\n *\n * @module Analytics\n */\nimport PropTypes from 'prop-types';\n\nconst optionsShape = {\n  config: PropTypes.object.isRequired,\n  httpClient: PropTypes.oneOfType([PropTypes.func, PropTypes.object]).isRequired,\n  loggingService: PropTypes.shape({\n    logError: PropTypes.func.isRequired,\n    logInfo: PropTypes.func.isRequired,\n  }).isRequired,\n};\n\nconst serviceShape = {\n  sendTrackingLogEvent: PropTypes.func.isRequired,\n  identifyAuthenticatedUser: PropTypes.func.isRequired,\n  identifyAnonymousUser: PropTypes.func.isRequired,\n  sendTrackEvent: PropTypes.func.isRequired,\n  sendPageEvent: PropTypes.func.isRequired,\n};\n\nlet service;\n\n/**\n *\n * @param {class} AnalyticsService\n * @param {*} options\n * @returns {AnalyticsService}\n */\nexport function configure(AnalyticsService, options) {\n  PropTypes.checkPropTypes(optionsShape, options, 'property', 'Analytics');\n  service = new AnalyticsService(options);\n  PropTypes.checkPropTypes(serviceShape, service, 'property', 'AnalyticsService');\n  return service;\n}\n\n/**\n *\n * @param {*} eventName\n * @param {*} properties\n * @returns {Promise}\n */\nexport function sendTrackingLogEvent(eventName, properties) {\n  return service.sendTrackingLogEvent(eventName, properties);\n}\n\n/**\n *\n *\n * @param {*} userId\n * @param {*} traits\n */\nexport function identifyAuthenticatedUser(userId, traits) {\n  service.identifyAuthenticatedUser(userId, traits);\n}\n\n/**\n *\n *\n * @param {*} traits\n * @returns {Promise}\n */\nexport function identifyAnonymousUser(traits) {\n  return service.identifyAnonymousUser(traits);\n}\n\n/**\n *\n *\n * @param {*} eventName\n * @param {*} properties\n */\nexport function sendTrackEvent(eventName, properties) {\n  service.sendTrackEvent(eventName, properties);\n}\n\n/**\n *\n *\n * @param {*} category\n * @param {*} name\n * @param {*} properties\n */\nexport function sendPageEvent(category, name, properties) {\n  service.sendPageEvent(category, name, properties);\n}\n\n/**\n *\n *\n * @returns {AnalyticsService}\n */\nexport function getAnalyticsService() {\n  if (!service) {\n    throw Error('You must first configure the analytics service.');\n  }\n\n  return service;\n}\n\n/**\n *\n */\nexport function resetAnalyticsService() {\n  service = null;\n}\n\n/**\n * @name AnalyticsService\n * @interface\n * @memberof module:Analytics\n * @property {function} identifyAnonymousUser\n * @property {function} identifyAuthenticatedUser\n * @property {function} sendPageEvent\n * @property {function} sendTrackEvent\n * @property {function} sendTrackingLogEvent\n */\n"],"mappings":"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"}