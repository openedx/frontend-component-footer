{"version":3,"file":"createJwtTokenProviderInterceptor.js","names":["createJwtTokenProviderInterceptor","options","jwtTokenService","shouldSkip","interceptor","axiosRequestConfig","getJwtToken","requestError","Object","create","message","config","Promise","reject","headers","common"],"sources":["../../../src/auth/interceptors/createJwtTokenProviderInterceptor.js"],"sourcesContent":["const createJwtTokenProviderInterceptor = (options) => {\n  const {\n    jwtTokenService,\n    shouldSkip,\n  } = options;\n\n  // Creating the interceptor inside this closure to\n  // maintain reference to the options supplied.\n  const interceptor = async (axiosRequestConfig) => {\n    if (shouldSkip(axiosRequestConfig)) {\n      return axiosRequestConfig;\n    }\n\n    // Important: the job of this interceptor is to refresh a jwt token and update\n    // the original request configuration. Errors thrown from fetching the jwt\n    // should contain the original request config. This allows other interceptors\n    // (namely our retry request interceptor below) to access the original request\n    // and handle it appropriately\n    try {\n      await jwtTokenService.getJwtToken();\n    } catch (error) {\n      const requestError = Object.create(error);\n      requestError.message = `[getJwtToken] ${requestError.message}`;\n      // Important: return the original axios request config\n      requestError.config = axiosRequestConfig;\n      return Promise.reject(requestError);\n    }\n\n    // Add the proper headers to tell the server to look for the jwt cookie\n    // eslint-disable-next-line no-param-reassign\n    axiosRequestConfig.headers.common['USE-JWT-COOKIE'] = true;\n    return axiosRequestConfig;\n  };\n\n  return interceptor;\n};\n\nexport default createJwtTokenProviderInterceptor;\n"],"mappings":";;;;AAAA,IAAMA,iCAAiC,GAAG,SAApCA,iCAAoC,CAACC,OAAD,EAAa;EACrD,IACEC,eADF,GAGID,OAHJ,CACEC,eADF;EAAA,IAEEC,UAFF,GAGIF,OAHJ,CAEEE,UAFF,CADqD,CAMrD;EACA;;EACA,IAAMC,WAAW;IAAA,mEAAG,iBAAOC,kBAAP;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA,KACdF,UAAU,CAACE,kBAAD,CADI;gBAAA;gBAAA;cAAA;;cAAA,iCAETA,kBAFS;;YAAA;cAAA;cAAA;cAAA,OAWVH,eAAe,CAACI,WAAhB,EAXU;;YAAA;cAAA;cAAA;;YAAA;cAAA;cAAA;cAaVC,YAbU,GAaKC,MAAM,CAACC,MAAP,aAbL;cAchBF,YAAY,CAACG,OAAb,2BAAwCH,YAAY,CAACG,OAArD,EAdgB,CAehB;;cACAH,YAAY,CAACI,MAAb,GAAsBN,kBAAtB;cAhBgB,iCAiBTO,OAAO,CAACC,MAAR,CAAeN,YAAf,CAjBS;;YAAA;cAoBlB;cACA;cACAF,kBAAkB,CAACS,OAAnB,CAA2BC,MAA3B,CAAkC,gBAAlC,IAAsD,IAAtD;cAtBkB,iCAuBXV,kBAvBW;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAH;;IAAA,gBAAXD,WAAW;MAAA;IAAA;EAAA,GAAjB;;EA0BA,OAAOA,WAAP;AACD,CAnCD;;AAqCA,eAAeJ,iCAAf"}