{"version":3,"file":"config.js","names":["APP_CONFIG_INITIALIZED","CONFIG_CHANGED","publish","subscribe","ensureDefinedConfig","extractRegex","envVar","trim","RegExp","undefined","ENVIRONMENT","process","env","NODE_ENV","config","ACCESS_TOKEN_COOKIE_NAME","BASE_URL","PUBLIC_PATH","CREDENTIALS_BASE_URL","CSRF_TOKEN_API_PATH","DISCOVERY_API_BASE_URL","PUBLISHER_BASE_URL","ECOMMERCE_BASE_URL","IGNORED_ERROR_REGEX","LANGUAGE_PREFERENCE_COOKIE_NAME","LEARNING_BASE_URL","LMS_BASE_URL","LOGIN_URL","LOGOUT_URL","STUDIO_BASE_URL","MARKETING_SITE_BASE_URL","ORDER_HISTORY_URL","REFRESH_ACCESS_TOKEN_ENDPOINT","SECURE_COOKIES","SEGMENT_KEY","SITE_NAME","USER_INFO_COOKIE_NAME","LOGO_URL","LOGO_TRADEMARK_URL","LOGO_WHITE_URL","FAVICON_URL","MFE_CONFIG_API_URL","APP_ID","getConfig","setConfig","newConfig","mergeConfig","Object","assign","ensureConfig","keys","requester","forEach","key","console","warn"],"sources":["../src/config.js"],"sourcesContent":["/**\n * #### Import members from **@edx/frontend-platform**\n *\n * The configuration module provides utilities for working with an application's configuration\n * document (ConfigDocument).  This module uses `process.env` to import configuration variables\n * from the command-line build process.  It can be dynamically extended at run-time using a\n * `config` initialization handler.  Please see the Initialization documentation for more\n * information on handlers and initialization phases.\n *\n * ```\n * import { getConfig } from '@edx/frontend-platform';\n *\n * const {\n *   BASE_URL,\n *   LMS_BASE_URL,\n *   LOGIN_URL,\n *   LOGIN_URL,\n *   REFRESH_ACCESS_TOKEN_ENDPOINT,\n *   ACCESS_TOKEN_COOKIE_NAME,\n *   CSRF_TOKEN_API_PATH,\n * } = getConfig();\n * ```\n *\n * @module Config\n */\n\nimport { APP_CONFIG_INITIALIZED, CONFIG_CHANGED } from './constants';\n\nimport { publish, subscribe } from './pubSub';\nimport { ensureDefinedConfig } from './utils';\n\nfunction extractRegex(envVar) {\n  // Convert the environment variable string to a regex, while guarding\n  // against a non-string and an empty/whitespace-only string.\n  if (typeof envVar === 'string' && envVar.trim() !== '') {\n    return new RegExp(envVar);\n  }\n  return undefined;\n}\n\nconst ENVIRONMENT = process.env.NODE_ENV;\nlet config = {\n  ACCESS_TOKEN_COOKIE_NAME: process.env.ACCESS_TOKEN_COOKIE_NAME,\n  BASE_URL: process.env.BASE_URL,\n  PUBLIC_PATH: process.env.PUBLIC_PATH || '/',\n  CREDENTIALS_BASE_URL: process.env.CREDENTIALS_BASE_URL,\n  CSRF_TOKEN_API_PATH: process.env.CSRF_TOKEN_API_PATH,\n  DISCOVERY_API_BASE_URL: process.env.DISCOVERY_API_BASE_URL,\n  PUBLISHER_BASE_URL: process.env.PUBLISHER_BASE_URL,\n  ECOMMERCE_BASE_URL: process.env.ECOMMERCE_BASE_URL,\n  ENVIRONMENT,\n  IGNORED_ERROR_REGEX: extractRegex(process.env.IGNORED_ERROR_REGEX),\n  LANGUAGE_PREFERENCE_COOKIE_NAME: process.env.LANGUAGE_PREFERENCE_COOKIE_NAME,\n  LEARNING_BASE_URL: process.env.LEARNING_BASE_URL,\n  LMS_BASE_URL: process.env.LMS_BASE_URL,\n  LOGIN_URL: process.env.LOGIN_URL,\n  LOGOUT_URL: process.env.LOGOUT_URL,\n  STUDIO_BASE_URL: process.env.STUDIO_BASE_URL,\n  MARKETING_SITE_BASE_URL: process.env.MARKETING_SITE_BASE_URL,\n  ORDER_HISTORY_URL: process.env.ORDER_HISTORY_URL,\n  REFRESH_ACCESS_TOKEN_ENDPOINT: process.env.REFRESH_ACCESS_TOKEN_ENDPOINT,\n  SECURE_COOKIES: ENVIRONMENT !== 'development',\n  SEGMENT_KEY: process.env.SEGMENT_KEY,\n  SITE_NAME: process.env.SITE_NAME,\n  USER_INFO_COOKIE_NAME: process.env.USER_INFO_COOKIE_NAME,\n  LOGO_URL: process.env.LOGO_URL,\n  LOGO_TRADEMARK_URL: process.env.LOGO_TRADEMARK_URL,\n  LOGO_WHITE_URL: process.env.LOGO_WHITE_URL,\n  FAVICON_URL: process.env.FAVICON_URL,\n  MFE_CONFIG_API_URL: process.env.MFE_CONFIG_API_URL,\n  APP_ID: process.env.APP_ID,\n};\n\n/**\n * Getter for the application configuration document.  This is synchronous and merely returns a\n * reference to an existing object, and is thus safe to call as often as desired.  The document\n * should have the following keys at a minimum:\n *\n * @returns {ConfigDocument}\n  */\nexport function getConfig() {\n  return config;\n}\n\n/**\n * Replaces the existing ConfigDocument.  This is not commonly used, but can be helpful for tests.\n *\n * The supplied config document will be tested with `ensureDefinedConfig` to ensure it does not\n * have any `undefined` keys.\n *\n * @param {ConfigDocument} newConfig\n */\nexport function setConfig(newConfig) {\n  ensureDefinedConfig(config, 'config');\n  config = newConfig;\n  publish(CONFIG_CHANGED);\n}\n\n/**\n * Merges additional configuration values into the ConfigDocument returned by `getConfig`.  Will\n * override any values that exist with the same keys.\n *\n * ```\n * mergeConfig({\n *   NEW_KEY: 'new value',\n *   OTHER_NEW_KEY: 'other new value',\n * });\n *\n * If any of the key values are `undefined`, an error will be logged to 'warn'.\n *\n * @param {Object} newConfig\n */\nexport function mergeConfig(newConfig) {\n  ensureDefinedConfig(newConfig, 'ProcessEnvConfigService');\n  config = Object.assign(config, newConfig);\n  publish(CONFIG_CHANGED);\n}\n\n/**\n * A method allowing application code to indicate that particular ConfigDocument keys are required\n * for them to function.  This is useful for diagnosing development/deployment issues, primarily,\n * by surfacing misconfigurations early.  For instance, if the build process fails to supply an\n * environment variable on the command-line, it's possible that one of the `process.env` variables\n * will be undefined.  Should be used in conjunction with `mergeConfig` for custom `ConfigDocument`\n * properties.  Requester is for informational/error reporting purposes only.\n *\n * ```\n * ensureConfig(['LMS_BASE_URL', 'LOGIN_URL'], 'MySpecialComponent');\n *\n * // Will log a warning with:\n * // \"App configuration error: LOGIN_URL is required by MySpecialComponent.\"\n * // if LOGIN_URL is undefined, for example.\n * ```\n *\n * *NOTE*: `ensureConfig` waits until `APP_CONFIG_INITIALIZED` is published to verify the existence\n * of the specified properties.  This means that this function is compatible with custom `config`\n * phase handlers responsible for loading additional configuration data in the initialization\n * sequence.\n *\n * @param {Array} keys\n * @param {string} [requester='unspecified application code']\n */\nexport function ensureConfig(keys, requester = 'unspecified application code') {\n  subscribe(APP_CONFIG_INITIALIZED, () => {\n    keys.forEach((key) => {\n      if (config[key] === undefined) {\n        // eslint-disable-next-line no-console\n        console.warn(`App configuration error: ${key} is required by ${requester}.`);\n      }\n    });\n  });\n}\n\n/**\n * An object describing the current application configuration.\n *\n * The implementation loads this document via `process.env` variables.\n *\n * ```\n * {\n *   BASE_URL: process.env.BASE_URL,\n *   // ... other vars\n * }\n * ```\n *\n * When using Webpack (i.e., normal usage), the build process is responsible for supplying these\n * variables via command-line environment variables.  That means they must be supplied at build\n * time.\n *\n * @name ConfigDocument\n * @memberof module:Config\n * @property {string} ACCESS_TOKEN_COOKIE_NAME\n * @property {string} BASE_URL The URL of the current application.\n * @property {string} CREDENTIALS_BASE_URL\n * @property {string} CSRF_TOKEN_API_PATH\n * @property {string} DISCOVERY_API_BASE_URL\n * @property {string} PUBLISHER_BASE_URL\n * @property {string} ECOMMERCE_BASE_URL\n * @property {string} ENVIRONMENT This is one of: development, production, or test.\n * @property {string} IGNORED_ERROR_REGEX\n * @property {string} LANGUAGE_PREFERENCE_COOKIE_NAME\n * @property {string} LEARNING_BASE_URL\n * @property {string} LMS_BASE_URL\n * @property {string} LOGIN_URL\n * @property {string} LOGOUT_URL\n * @property {string} STUDIO_BASE_URL\n * @property {string} MARKETING_SITE_BASE_URL\n * @property {string} ORDER_HISTORY_URL\n * @property {string} REFRESH_ACCESS_TOKEN_ENDPOINT\n * @property {boolean} SECURE_COOKIES\n * @property {string} SEGMENT_KEY\n * @property {string} SITE_NAME\n * @property {string} USER_INFO_COOKIE_NAME\n * @property {string} LOGO_URL\n * @property {string} LOGO_TRADEMARK_URL\n * @property {string} LOGO_WHITE_URL\n * @property {string} FAVICON_URL\n * @property {string} MFE_CONFIG_API_URL\n * @property {string} APP_ID\n */\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAASA,sBAAT,EAAiCC,cAAjC,QAAuD,aAAvD;AAEA,SAASC,OAAT,EAAkBC,SAAlB,QAAmC,UAAnC;AACA,SAASC,mBAAT,QAAoC,SAApC;;AAEA,SAASC,YAAT,CAAsBC,MAAtB,EAA8B;EAC5B;EACA;EACA,IAAI,OAAOA,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,CAACC,IAAP,OAAkB,EAApD,EAAwD;IACtD,OAAO,IAAIC,MAAJ,CAAWF,MAAX,CAAP;EACD;;EACD,OAAOG,SAAP;AACD;;AAED,IAAMC,WAAW,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAhC;AACA,IAAIC,MAAM,GAAG;EACXC,wBAAwB,EAAEJ,OAAO,CAACC,GAAR,CAAYG,wBAD3B;EAEXC,QAAQ,EAAEL,OAAO,CAACC,GAAR,CAAYI,QAFX;EAGXC,WAAW,EAAEN,OAAO,CAACC,GAAR,CAAYK,WAAZ,IAA2B,GAH7B;EAIXC,oBAAoB,EAAEP,OAAO,CAACC,GAAR,CAAYM,oBAJvB;EAKXC,mBAAmB,EAAER,OAAO,CAACC,GAAR,CAAYO,mBALtB;EAMXC,sBAAsB,EAAET,OAAO,CAACC,GAAR,CAAYQ,sBANzB;EAOXC,kBAAkB,EAAEV,OAAO,CAACC,GAAR,CAAYS,kBAPrB;EAQXC,kBAAkB,EAAEX,OAAO,CAACC,GAAR,CAAYU,kBARrB;EASXZ,WAAW,EAAXA,WATW;EAUXa,mBAAmB,EAAElB,YAAY,CAACM,OAAO,CAACC,GAAR,CAAYW,mBAAb,CAVtB;EAWXC,+BAA+B,EAAEb,OAAO,CAACC,GAAR,CAAYY,+BAXlC;EAYXC,iBAAiB,EAAEd,OAAO,CAACC,GAAR,CAAYa,iBAZpB;EAaXC,YAAY,EAAEf,OAAO,CAACC,GAAR,CAAYc,YAbf;EAcXC,SAAS,EAAEhB,OAAO,CAACC,GAAR,CAAYe,SAdZ;EAeXC,UAAU,EAAEjB,OAAO,CAACC,GAAR,CAAYgB,UAfb;EAgBXC,eAAe,EAAElB,OAAO,CAACC,GAAR,CAAYiB,eAhBlB;EAiBXC,uBAAuB,EAAEnB,OAAO,CAACC,GAAR,CAAYkB,uBAjB1B;EAkBXC,iBAAiB,EAAEpB,OAAO,CAACC,GAAR,CAAYmB,iBAlBpB;EAmBXC,6BAA6B,EAAErB,OAAO,CAACC,GAAR,CAAYoB,6BAnBhC;EAoBXC,cAAc,EAAEvB,WAAW,KAAK,aApBrB;EAqBXwB,WAAW,EAAEvB,OAAO,CAACC,GAAR,CAAYsB,WArBd;EAsBXC,SAAS,EAAExB,OAAO,CAACC,GAAR,CAAYuB,SAtBZ;EAuBXC,qBAAqB,EAAEzB,OAAO,CAACC,GAAR,CAAYwB,qBAvBxB;EAwBXC,QAAQ,EAAE1B,OAAO,CAACC,GAAR,CAAYyB,QAxBX;EAyBXC,kBAAkB,EAAE3B,OAAO,CAACC,GAAR,CAAY0B,kBAzBrB;EA0BXC,cAAc,EAAE5B,OAAO,CAACC,GAAR,CAAY2B,cA1BjB;EA2BXC,WAAW,EAAE7B,OAAO,CAACC,GAAR,CAAY4B,WA3Bd;EA4BXC,kBAAkB,EAAE9B,OAAO,CAACC,GAAR,CAAY6B,kBA5BrB;EA6BXC,MAAM,EAAE/B,OAAO,CAACC,GAAR,CAAY8B;AA7BT,CAAb;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,SAAT,GAAqB;EAC1B,OAAO7B,MAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAAS8B,SAAT,CAAmBC,SAAnB,EAA8B;EACnCzC,mBAAmB,CAACU,MAAD,EAAS,QAAT,CAAnB;EACAA,MAAM,GAAG+B,SAAT;EACA3C,OAAO,CAACD,cAAD,CAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAAS6C,WAAT,CAAqBD,SAArB,EAAgC;EACrCzC,mBAAmB,CAACyC,SAAD,EAAY,yBAAZ,CAAnB;EACA/B,MAAM,GAAGiC,MAAM,CAACC,MAAP,CAAclC,MAAd,EAAsB+B,SAAtB,CAAT;EACA3C,OAAO,CAACD,cAAD,CAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASgD,YAAT,CAAsBC,IAAtB,EAAwE;EAAA,IAA5CC,SAA4C,uEAAhC,8BAAgC;EAC7EhD,SAAS,CAACH,sBAAD,EAAyB,YAAM;IACtCkD,IAAI,CAACE,OAAL,CAAa,UAACC,GAAD,EAAS;MACpB,IAAIvC,MAAM,CAACuC,GAAD,CAAN,KAAgB5C,SAApB,EAA+B;QAC7B;QACA6C,OAAO,CAACC,IAAR,oCAAyCF,GAAzC,6BAA+DF,SAA/D;MACD;IACF,CALD;EAMD,CAPQ,CAAT;AAQD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}