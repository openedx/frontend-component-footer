{"version":3,"file":"index.js","names":["React","PropTypes","classNames","DropdownButton","DropdownMenu","DropdownItem","withDeprecatedProps","DEPR_TYPES","createContext","Provider","Consumer","Dropdown","props","e","containerRef","current","contains","target","state","open","close","key","preventDefault","focusPrevious","focusNext","shiftKey","stopPropagation","uniqueId","idCounter","triggerId","createRef","menuRef","buttonRef","prevProps","prevState","focusFirst","focus","document","removeEventListener","handleDocumentClick","selector","Array","from","querySelectorAll","setState","addEventListener","focusableElements","getFocusableElements","length","allFocusableElements","activeIndex","indexOf","activeElement","nextIndex","previousIndex","children","other","show","className","handleMenuKeyDown","isOpen","toggle","Component","propTypes","node","isRequired","Item","Button","Menu","DropdownWithDeprecatedProps","menuItems","deprType","MOVED_AND_FORMAT","message","newName","transform","allProps","isArray","isValidElement","iconElement","title","map","menuItem","i","cloneElement","href","label","REMOVED","buttonType","defaultProps"],"sources":["../../../src/Dropdown/deprecated/index.jsx"],"sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\n// eslint-disable-next-line import/no-cycle\nimport DropdownButton from './DropdownButton';\n// eslint-disable-next-line import/no-cycle\nimport DropdownMenu from './DropdownMenu';\nimport DropdownItem from './DropdownItem';\n\nimport withDeprecatedProps, { DEPR_TYPES } from '../../withDeprecatedProps';\n\nconst { Provider, Consumer } = React.createContext();\n\nclass Dropdown extends React.Component {\n  // eslint-disable-next-line react/sort-comp\n  static idCounter = 0; // For creating unique ids\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      open: false,\n    };\n\n    // Used for aria labelling. Increment the id counter so the next id can be unique\n    this.uniqueId = Dropdown.idCounter;\n    Dropdown.idCounter += 1;\n    this.triggerId = `pgn__dropdown-trigger-${this.uniqueId}`;\n\n    this.containerRef = React.createRef();\n    this.menuRef = React.createRef();\n    this.buttonRef = React.createRef();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.open !== this.state.open) {\n      if (this.state.open) {\n        this.focusFirst();\n      } else {\n        this.buttonRef.current.focus();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.handleDocumentClick, true);\n  }\n\n  getFocusableElements() {\n    const selector = 'button:not([disabled]), [href]:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"]):not([disabled])';\n    return Array.from(this.menuRef.current.querySelectorAll(selector));\n  }\n\n  handleDocumentClick = (e) => {\n    if (this.containerRef.current.contains(e.target) && this.containerRef.current !== e.target) {\n      return;\n    }\n    if (this.state.open) {\n      this.close();\n    }\n  }\n\n  handleMenuKeyDown = (e) => {\n    switch (e.key) {\n      case 'ArrowUp':\n        e.preventDefault();\n        this.focusPrevious();\n        break;\n      case 'ArrowDown':\n        e.preventDefault();\n        this.focusNext();\n        break;\n      case 'Tab':\n        e.preventDefault();\n        if (e.shiftKey) {\n          this.focusPrevious();\n        } else {\n          this.focusNext();\n        }\n        break;\n      case 'Escape':\n        e.stopPropagation();\n        this.close();\n        break;\n      default:\n        break;\n    }\n  }\n\n  toggle = () => {\n    if (this.state.open) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  close() {\n    document.removeEventListener('click', this.handleDocumentClick, true);\n    this.setState({\n      open: false,\n    });\n  }\n\n  open() {\n    // adding event listener here so the user can close dropdown on click outside of the dropdown\n    document.addEventListener('click', this.handleDocumentClick, true);\n    this.setState({\n      open: true,\n    });\n  }\n\n  focusFirst() {\n    const focusableElements = this.getFocusableElements();\n    if (focusableElements.length) { focusableElements[0].focus(); }\n  }\n\n  focusNext() {\n    const allFocusableElements = this.getFocusableElements();\n    if (allFocusableElements.length === 0) { return; }\n    const activeIndex = allFocusableElements.indexOf(document.activeElement);\n    const nextIndex = (activeIndex + 1) % allFocusableElements.length;\n    allFocusableElements[nextIndex].focus();\n  }\n\n  focusPrevious() {\n    const allFocusableElements = this.getFocusableElements();\n    if (allFocusableElements.length === 0) { return; }\n    const activeIndex = allFocusableElements.indexOf(document.activeElement);\n    const previousIndex = ((activeIndex - 1) + allFocusableElements.length) % allFocusableElements.length;\n    allFocusableElements[previousIndex].focus();\n  }\n\n  render() {\n    const { children, ...other } = this.props;\n\n    return (\n      <div\n        {...other}\n        className={classNames(\n          'dropdown',\n          { show: this.state.open },\n          other.className,\n        )}\n        ref={this.containerRef}\n      >\n        <Provider\n          value={{\n            buttonRef: this.buttonRef,\n            handleMenuKeyDown: this.handleMenuKeyDown,\n            isOpen: this.state.open,\n            menuRef: this.menuRef,\n            toggle: this.toggle,\n            triggerId: this.triggerId,\n          }}\n        >\n          {children}\n        </Provider>\n      </div>\n    );\n  }\n}\n\nDropdown.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nDropdown.Item = DropdownItem;\nDropdown.Button = DropdownButton;\nDropdown.Menu = DropdownMenu;\n\nconst DropdownWithDeprecatedProps = withDeprecatedProps(Dropdown, 'Dropdown', {\n  menuItems: {\n    deprType: DEPR_TYPES.MOVED_AND_FORMAT,\n    message: 'They should be components sent as children.',\n    newName: 'children',\n    transform: (menuItems, allProps) => {\n      if (!Array.isArray(menuItems)) { return null; }\n      return (\n        <>\n          <DropdownButton>\n            {React.isValidElement(allProps.iconElement) ? allProps.iconElement : null }\n            {allProps.title}\n          </DropdownButton>\n          <DropdownMenu>\n            {menuItems.map((menuItem, i) => {\n            /* eslint-disable react/no-array-index-key */\n              if (React.isValidElement(menuItem)) {\n                return React.cloneElement(menuItem, {\n                  className: 'dropdown-item',\n                  key: i,\n                });\n              }\n              return <DropdownItem key={i} href={menuItem.href}>{menuItem.label}</DropdownItem>;\n            /* eslint-enable react/no-array-index-key */\n            })}\n          </DropdownMenu>\n        </>\n      );\n    },\n  },\n  title: {\n    deprType: DEPR_TYPES.REMOVED,\n    message: 'It should be specified inside the Dropdown.Button component',\n  },\n  buttonType: {\n    deprType: DEPR_TYPES.REMOVED,\n    message: 'It should be specified as a className prop',\n  },\n  iconElement: {\n    deprType: DEPR_TYPES.REMOVED,\n    message: 'It should be specified inside the buttonContent prop.',\n  },\n});\n\nDropdownWithDeprecatedProps.propTypes = Dropdown.propTypes;\nDropdownWithDeprecatedProps.defaultProps = Dropdown.defaultProps;\nDropdownWithDeprecatedProps.Item = Dropdown.Item;\nDropdownWithDeprecatedProps.Button = Dropdown.Button;\nDropdownWithDeprecatedProps.Menu = Dropdown.Menu;\n\nexport { Provider, Consumer };\nexport default DropdownWithDeprecatedProps;\n"],"mappings":"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"}