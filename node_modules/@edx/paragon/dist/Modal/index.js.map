{"version":3,"file":"index.js","names":["React","ReactDOM","classNames","PropTypes","FocusOn","tabbable","Button","Icon","newId","Variant","Close","Modal","props","close","bind","headerId","modalBodyRef","createRef","document","el","createElement","isIE11","global","MSInputMethodContext","documentMode","state","open","parentSelector","parentElement","querySelector","Error","appendChild","prevProps","prevState","setState","unmountComponentAtNode","variant","variantIconClassName","status","WARNING","toLowerCase","body","getVariantIconClassName","current","Object","values","includes","e","stopPropagation","onClose","buttons","map","button","isValidElement","cloneElement","key","children","label","buttonProps","isValidVariantStatus","getVariantGridBody","dialogClassName","renderDefaultCloseButton","renderHeaderCloseButton","closeText","title","hasTabbableElements","length","getTabbableBodyElements","renderModalFooter","show","fade","tabIndex","renderBody","renderButtons","createPortal","renderModal","Component","propTypes","bool","string","oneOfType","element","isRequired","arrayOf","shape","func","defaultProps","undefined"],"sources":["../../src/Modal/index.jsx"],"sourcesContent":["/* eslint-disable max-len */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { FocusOn } from 'react-focus-on';\nimport tabbable from 'tabbable';\n\nimport { Button } from '..';\nimport Icon from '../Icon';\nimport newId from '../utils/newId';\nimport Variant from '../utils/constants';\nimport { Close } from '../../icons';\n\nclass Modal extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.close = this.close.bind(this);\n\n    this.headerId = newId();\n    this.modalBodyRef = React.createRef();\n\n    if (typeof document !== 'undefined') {\n      this.el = document.createElement('div');\n      // Sets true for IE11, false otherwise: https://stackoverflow.com/a/22082397/6620612\n      this.isIE11 = !!global.MSInputMethodContext && !!document.documentMode;\n    }\n\n    this.state = {\n      open: props.open,\n    };\n  }\n\n  componentDidMount() {\n    const { parentSelector } = this.props;\n    this.parentElement = document.querySelector(parentSelector);\n    if (this.parentElement === null) {\n      throw new Error(`Modal received invalid parentSelector: ${parentSelector}, no matching element found`);\n    }\n    this.parentElement.appendChild(this.el);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { open } = this.props;\n    if (open !== prevProps.open || open !== prevState.open) {\n      // eslint-disable-next-line react/no-did-update-set-state\n      this.setState({ open });\n    }\n  }\n\n  componentWillUnmount() {\n    ReactDOM.unmountComponentAtNode(this.parentElement);\n  }\n\n  getVariantIconClassName() {\n    const { variant } = this.props;\n    let variantIconClassName;\n\n    switch (variant.status) {\n      case Variant.status.WARNING:\n        variantIconClassName = classNames(\n          'fa',\n          'fa-exclamation-triangle',\n          'fa-3x',\n          `text-${variant.status.toLowerCase()}`,\n        );\n        break;\n      default:\n        break;\n    }\n\n    return variantIconClassName;\n  }\n\n  getVariantGridBody(body) {\n    const { variant } = this.props;\n\n    return (\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <div className=\"col-md-10\">\n            <div>\n              {body}\n            </div>\n          </div>\n          <div className=\"col-md-2\">\n            <Icon\n              id={newId(`Modal-${variant.status}`)}\n              className={this.getVariantIconClassName()}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getTabbableBodyElements() {\n    if (this.modalBodyRef?.current) {\n      return tabbable(this.modalBodyRef.current);\n    }\n    return [];\n  }\n\n  isValidVariantStatus() {\n    const { variant } = this.props;\n    return Object.values(Variant.status).includes(variant.status);\n  }\n\n  close(e) {\n    if (e) {\n      e.stopPropagation();\n    }\n\n    this.setState({ open: false });\n    this.props.onClose();\n  }\n\n  renderButtons() {\n    return this.props.buttons.map((button) => {\n      // button is either a React component that we want clone or a set of props\n      if (React.isValidElement(button)) {\n        return React.cloneElement(button, {\n          key: button.props.children,\n        });\n      }\n\n      const { label, ...buttonProps } = button;\n\n      return (\n        <Button.Deprecated\n          {...buttonProps}\n          key={label}\n        >\n          {label}\n        </Button.Deprecated>\n      );\n    });\n  }\n\n  renderBody() {\n    let { body } = this.props;\n\n    if (typeof body === 'string') {\n      body = <p>{body}</p>;\n    }\n\n    if (this.isValidVariantStatus()) {\n      body = this.getVariantGridBody(body);\n    }\n\n    return body;\n  }\n\n  renderModal() {\n    const { open } = this.state;\n    const {\n      dialogClassName,\n      renderDefaultCloseButton,\n      renderHeaderCloseButton,\n      buttons,\n      closeText,\n      title,\n    } = this.props;\n\n    const hasTabbableElements = (\n      renderDefaultCloseButton\n      || renderHeaderCloseButton\n      || buttons.length > 0\n      || this.getTabbableBodyElements().length > 0\n    );\n    const renderModalFooter = renderDefaultCloseButton || buttons.length > 0;\n\n    return (\n      <>\n        <div\n          className={classNames({\n            'modal-backdrop': open,\n            show: open,\n            fade: !open,\n          })}\n          role=\"presentation\"\n        />\n        <div\n          className={classNames(\n            'modal',\n            {\n              show: open,\n              fade: !open,\n              'd-block': open,\n              'is-ie11': this.isIE11,\n            },\n          )}\n          role=\"presentation\"\n        >\n          <div\n            className={classNames(\n              {\n                'modal-dialog': open,\n              },\n              dialogClassName,\n            )}\n            role=\"dialog\"\n            aria-modal\n            aria-labelledby={this.headerId}\n          >\n            <FocusOn\n              enabled={open}\n              onClickOutside={this.close}\n              onEscapeKey={this.close}\n            >\n              <div\n                className=\"modal-content\"\n                // if the modal doesn't contain any tabbable elements, make this element programmatically focusable.\n                {...(!hasTabbableElements ? { tabIndex: -1 } : {})}\n              >\n                <div className=\"modal-header\">\n                  <h2 className=\"modal-title\" id={this.headerId}>{title}</h2>\n                  {renderHeaderCloseButton && (\n                    <Button.Deprecated\n                      className=\"p-1\"\n                      onClick={this.close}\n                    >\n                      <Icon src={Close} screenReaderText={closeText} />\n                    </Button.Deprecated>\n                  )}\n                </div>\n                <div className=\"modal-body\" ref={this.modalBodyRef}>\n                  {this.renderBody()}\n                </div>\n                {renderModalFooter && (\n                  <div className=\"modal-footer\">\n                    {renderDefaultCloseButton && (\n                      <Button\n                        variant=\"link\"\n                        onClick={this.close}\n                      >\n                        {closeText}\n                      </Button>\n                    )}\n                    {this.renderButtons()}\n                  </div>\n                )}\n              </div>\n            </FocusOn>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  render() {\n    if (!this.el) {\n      return null;\n    }\n\n    return ReactDOM.createPortal(\n      this.renderModal(),\n      this.el,\n    );\n  }\n}\n\nModal.propTypes = {\n  /** specifies whether the modal renders open or closed on the initial render. It defaults to false. */\n  open: PropTypes.bool,\n  /** is the selector for an element in the dom which the modal should be rendered under. It uses querySelector to find the first element that matches that selector, and then creates a react portal to a div underneath the parent element.\n */\n  parentSelector: PropTypes.string,\n  /** a string or an element that is rendered inside of the modal title, above the modal body. */\n  title: PropTypes.oneOfType([PropTypes.string, PropTypes.element]).isRequired,\n  /** a string or an element that is rendered inside of the modal body, between the title and the footer. */\n  body: PropTypes.oneOfType([PropTypes.string, PropTypes.element]).isRequired,\n  /** an array of either elements or shapes that take the form of the buttonPropTypes. See the [buttonPropTypes](https://github.com/edx/paragon/blob/master/src/Button/index.jsx#L40) for a list of acceptable props to pass as part of a button. */\n  buttons: PropTypes.arrayOf(PropTypes.oneOfType([\n    PropTypes.element,\n    PropTypes.shape({}), // TODO: Only accept nodes in the future\n  ])),\n  /** specifies the display text of the default Close button. It defaults to \"Close\". */\n  closeText: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n  /** a function that is called on close. It can be used to perform actions upon closing of the modal, such as restoring focus to the previous logical focusable element. */\n  onClose: PropTypes.func.isRequired,\n  variant: PropTypes.shape({\n    status: PropTypes.string,\n  }),\n  /** specifies whether the default close button is rendered in the footer. It defaults to true. */\n  renderDefaultCloseButton: PropTypes.bool,\n  /** specifies whether a close button is rendered in the modal header. It defaults to true. */\n  renderHeaderCloseButton: PropTypes.bool,\n  /**\n   * Specifies optional classes to add to the element with the '.modal-dialog' class.  See Bootstrap documentation for possible classes.  Some options: modal-lg, modal-sm, modal-dialog-centered\n   */\n  dialogClassName: PropTypes.string,\n};\n\nModal.defaultProps = {\n  open: false,\n  parentSelector: 'body',\n  buttons: [],\n  closeText: 'Close',\n  variant: {},\n  renderDefaultCloseButton: true,\n  renderHeaderCloseButton: true,\n  dialogClassName: undefined,\n};\n\nexport default Modal;\n"],"mappings":"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"}