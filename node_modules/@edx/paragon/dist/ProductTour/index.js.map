{"version":3,"file":"index.js","names":["React","useEffect","useState","PropTypes","Checkpoint","ProductTour","forwardRef","ref","tours","tourValue","find","tour","enabled","checkpoints","startingIndex","onEscape","onEnd","tourOnDismiss","onDismiss","tourAdvanceButtonText","advanceButtonText","tourDismissButtonText","dismissButtonText","tourEndButtonText","endButtonText","currentCheckpointData","setCurrentCheckpointData","index","setIndex","isTourEnabled","setIsTourEnabled","prunedCheckpoints","setPrunedCheckpoints","title","body","onAdvance","placement","target","showDismissButton","pruneCheckpoints","checkpointList","checkpointsWithRenderedTargets","filter","checkpoint","document","querySelector","length","handleEsc","event","keyCode","global","addEventListener","removeEventListener","handleAdvance","handleDismiss","handleEnd","defaultProps","undefined","propTypes","arrayOf","shape","node","func","oneOf","string","isRequired","bool","number","tourId"],"sources":["../../src/ProductTour/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport Checkpoint from './Checkpoint';\n\nconst ProductTour = React.forwardRef(({ tours }, ref) => {\n  const tourValue = tours.find((tour) => tour.enabled);\n  const {\n    enabled, checkpoints = [], startingIndex, onEscape, onEnd, onDismiss: tourOnDismiss,\n    advanceButtonText: tourAdvanceButtonText, dismissButtonText: tourDismissButtonText,\n    endButtonText: tourEndButtonText,\n  } = tourValue || {};\n  const [currentCheckpointData, setCurrentCheckpointData] = useState([]);\n  const [index, setIndex] = useState(0);\n  const [isTourEnabled, setIsTourEnabled] = useState(false);\n  const [prunedCheckpoints, setPrunedCheckpoints] = useState([]);\n  const {\n    title, body, onAdvance, onDismiss, advanceButtonText, dismissButtonText,\n    endButtonText, placement, target, showDismissButton,\n  } = currentCheckpointData || {};\n\n  /**\n   * Takes a list of checkpoints and verifies that each target string provided is\n   * an element in the DOM.\n   */\n  const pruneCheckpoints = (checkpointList) => {\n    const checkpointsWithRenderedTargets = checkpointList.filter(\n      (checkpoint) => !!document.querySelector(checkpoint.target),\n    );\n    setPrunedCheckpoints(checkpointsWithRenderedTargets);\n  };\n\n  useEffect(() => {\n    if (enabled && checkpoints) {\n      setIsTourEnabled(enabled);\n      pruneCheckpoints(checkpoints);\n      setIndex(startingIndex || 0);\n    }\n  }, [enabled, checkpoints, startingIndex]);\n\n  useEffect(() => {\n    if (isTourEnabled && prunedCheckpoints.length) {\n      setCurrentCheckpointData(prunedCheckpoints[index]);\n    }\n  }, [index, isTourEnabled, prunedCheckpoints]);\n\n  useEffect(() => {\n    const handleEsc = (event) => {\n      if (event.keyCode === 27) {\n        setIsTourEnabled(false);\n        if (onEscape) {\n          onEscape();\n        }\n      }\n    };\n    global.addEventListener('keydown', handleEsc);\n\n    return () => {\n      global.removeEventListener('keydown', handleEsc);\n    };\n  }, [onEscape]);\n\n  if (!tourValue || !currentCheckpointData || !isTourEnabled) {\n    return null;\n  }\n\n  const handleAdvance = () => {\n    setIndex(index + 1);\n    if (onAdvance) {\n      onAdvance();\n    }\n  };\n\n  const handleDismiss = () => {\n    setIndex(0);\n    setIsTourEnabled(false);\n    if (onDismiss) {\n      onDismiss();\n    } else {\n      tourOnDismiss();\n    }\n    setCurrentCheckpointData(null);\n  };\n\n  const handleEnd = () => {\n    setIndex(0);\n    setIsTourEnabled(false);\n    if (onEnd) {\n      onEnd();\n    }\n    setCurrentCheckpointData(null);\n  };\n\n  return (\n    <Checkpoint\n      advanceButtonText={advanceButtonText || tourAdvanceButtonText}\n      body={body}\n      currentCheckpointData={currentCheckpointData}\n      dismissButtonText={dismissButtonText || tourDismissButtonText}\n      endButtonText={endButtonText || tourEndButtonText}\n      index={index}\n      onAdvance={handleAdvance}\n      onDismiss={handleDismiss}\n      onEnd={handleEnd}\n      placement={placement}\n      target={target}\n      title={title}\n      totalCheckpoints={prunedCheckpoints.length}\n      showDismissButton={showDismissButton}\n      ref={ref}\n    />\n  );\n});\n\nProductTour.defaultProps = {\n  tours: {\n    advanceButtonText: '',\n    checkpoints: {\n      advanceButtonText: '',\n      body: '',\n      dismissButtonText: '',\n      endButtonText: '',\n      onAdvance: () => {},\n      onDismiss: () => {},\n      placement: 'top',\n      title: '',\n      showDismissButton: undefined,\n    },\n    dismissButtonText: '',\n    endButtonText: '',\n    onDismiss: () => {},\n    onEnd: () => {},\n    onEscape: () => {},\n    startingIndex: 0,\n  },\n};\n\nProductTour.propTypes = {\n  tours: PropTypes.arrayOf(PropTypes.shape({\n    /** The text displayed on all buttons used to advance the tour. */\n    advanceButtonText: PropTypes.node,\n    /** An array comprised of checkpoint objects supporting the following values: */\n    checkpoints: PropTypes.arrayOf(PropTypes.shape({\n      /** The text displayed on the button used to advance the tour for the given Checkpoint\n       * (overrides the* `advanceButtonText` defined in the parent tour object). */\n      advanceButtonText: PropTypes.node,\n      /** The text displayed in the body of the Checkpoint */\n      body: PropTypes.node,\n      /** The text displayed on the button used to dismiss the tour for the given Checkpoint\n       * (overrides the `dismissButtonText` defined in the parent tour object). */\n      dismissButtonText: PropTypes.node,\n      /** The text displayed on the button used to end the tour for the given Checkpoint\n       * (overrides the `endButtonText` defined in the parent tour object). */\n      endButtonText: PropTypes.node,\n      /** A function that runs when triggering the `onClick` event of the advance\n       * button for the given Checkpoint. */\n      onAdvance: PropTypes.func,\n      /** A function that runs when triggering the `onClick` event of the dismiss\n       * button for the given Checkpoint (overrides the `onDismiss` function defined in the parent tour object). */\n      onDismiss: PropTypes.func,\n      /** A string that dictates the alignment of the Checkpoint around its target. */\n      placement: PropTypes.oneOf([\n        'top', 'top-start', 'top-end', 'right-start', 'right', 'right-end',\n        'left-start', 'left', 'left-end', 'bottom', 'bottom-start', 'bottom-end',\n      ]),\n      /** The CSS selector for the Checkpoint's desired target. */\n      target: PropTypes.string.isRequired,\n      /** The text displayed in the title of the Checkpoint */\n      title: PropTypes.node,\n      /** Enforces visibility of the dismiss button under all circumstances */\n      showDismissButton: PropTypes.bool,\n    })),\n    /** The text displayed on the button used to dismiss the tour. */\n    dismissButtonText: PropTypes.node,\n    /** Whether the tour is enabled. If there are multiple tours defined, only one should be enabled at a time. */\n    enabled: PropTypes.bool.isRequired,\n    /** The text displayed on the button used to end the tour. */\n    endButtonText: PropTypes.node,\n    /** A function that runs when triggering the `onClick` event of the dismiss button. */\n    onDismiss: PropTypes.func,\n    /** A function that runs when triggering the `onClick` event of the end button. */\n    onEnd: PropTypes.func,\n    /** A function that runs when pressing the Escape key. */\n    onEscape: PropTypes.func,\n    /** The index of the desired `Checkpoint` to render when the tour starts. */\n    startingIndex: PropTypes.number,\n    /** The ID of the tour */\n    tourId: PropTypes.string.isRequired,\n  })),\n};\n\nexport default ProductTour;\n"],"mappings":"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"}