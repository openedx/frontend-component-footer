{"version":3,"file":"index.js","names":["React","useCallback","useEffect","ProgressBarBase","PropTypes","classNames","Annotation","placeInfoAtZero","ANNOTATION_CLASS","HINT_SWAP_PERCENT","PROGRESS_DEFAULT_VARIANT","THRESHOLD_DEFAULT_VARIANT","VARIANTS","ProgressBar","props","ProgressBarAnnotated","now","label","variant","threshold","thresholdLabel","thresholdVariant","progressHint","thresholdHint","progressInfoRef","useRef","thresholdInfoRef","thresholdPercent","isProgressHintAfter","isThresholdHintAfter","progressColor","includes","thresholdColor","positionAnnotations","observer","ResizeObserver","progressInfoEl","current","observe","unobserve","getHint","text","left","propTypes","number","node","oneOf","className","string","defaultProps","undefined","Annotated"],"sources":["../../src/ProgressBar/index.jsx"],"sourcesContent":["import React, { useCallback, useEffect } from 'react';\nimport ProgressBarBase from 'react-bootstrap/ProgressBar';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport Annotation from '../Annotation';\nimport { placeInfoAtZero } from './utils';\n\nexport const ANNOTATION_CLASS = 'pgn__annotation';\nconst HINT_SWAP_PERCENT = 50;\nconst PROGRESS_DEFAULT_VARIANT = 'warning';\nconst THRESHOLD_DEFAULT_VARIANT = 'dark';\nconst VARIANTS = [\n  'dark',\n  'warning',\n  'success',\n  'error',\n];\n\nconst ProgressBar = (props) => <ProgressBarBase {...props} />;\n\nconst ProgressBarAnnotated = ({\n  now,\n  label,\n  variant,\n  threshold,\n  thresholdLabel,\n  thresholdVariant,\n  progressHint,\n  thresholdHint,\n  ...props\n}) => {\n  const progressInfoRef = React.useRef();\n  const thresholdInfoRef = React.useRef();\n  const thresholdPercent = (threshold || 0) - (now || 0);\n  const isProgressHintAfter = now < HINT_SWAP_PERCENT;\n  const isThresholdHintAfter = threshold < HINT_SWAP_PERCENT;\n  const progressColor = VARIANTS.includes(variant) ? variant : PROGRESS_DEFAULT_VARIANT;\n  const thresholdColor = VARIANTS.includes(thresholdVariant) ? thresholdVariant : THRESHOLD_DEFAULT_VARIANT;\n\n  const positionAnnotations = useCallback(() => {\n    placeInfoAtZero(progressInfoRef, isProgressHintAfter, ANNOTATION_CLASS);\n    placeInfoAtZero(thresholdInfoRef, isThresholdHintAfter, ANNOTATION_CLASS);\n  }, [isProgressHintAfter, isThresholdHintAfter]);\n\n  useEffect(() => {\n    positionAnnotations();\n    const observer = new ResizeObserver(() => {\n      positionAnnotations();\n    });\n    const progressInfoEl = progressInfoRef.current;\n    observer.observe(progressInfoEl);\n    return () => progressInfoEl && observer.unobserve(progressInfoEl);\n  }, [positionAnnotations]);\n\n  const getHint = (text) => (\n    <span className=\"pgn__progress-hint\">\n      {text}\n    </span>\n  );\n\n  return (\n    <div className=\"pgn__progress-annotated\">\n      {!!label && (\n        <div\n          className=\"pgn__progress-info\"\n          style={{ left: `${now}%` }}\n          ref={progressInfoRef}\n        >\n          {!isProgressHintAfter && getHint(progressHint)}\n          <Annotation variant={progressColor}>\n            {label}\n          </Annotation>\n          {isProgressHintAfter && getHint(progressHint)}\n        </div>\n      )}\n      <ProgressBarBase>\n        <ProgressBarBase\n          {...props}\n          now={now}\n          className={classNames(\n            `pgn__progress-bar--${progressColor}`,\n            thresholdPercent > 0 ? 'pgn__progress-tick--white' : 'pgn__progress-tick--black',\n          )}\n          srOnly\n        />\n        {!!threshold && (\n          <ProgressBarBase\n            now={thresholdPercent}\n            className={`pgn__progress-bar--${thresholdColor}`}\n            srOnly\n          />\n        )}\n      </ProgressBarBase>\n      {(!!threshold && !!thresholdLabel) && (\n        <div\n          className=\"pgn__progress-info\"\n          style={{ left: `${threshold}%` }}\n          ref={thresholdInfoRef}\n        >\n          {!isThresholdHintAfter && getHint(thresholdHint)}\n          <Annotation\n            arrowPlacement=\"top\"\n            variant={thresholdColor}\n          >\n            {thresholdLabel}\n          </Annotation>\n          {isThresholdHintAfter && getHint(thresholdHint)}\n        </div>\n      )}\n    </div>\n  );\n};\n\nProgressBarAnnotated.propTypes = {\n  /** Current value of progress. */\n  now: PropTypes.number,\n  /** Show label that represents visual percentage. */\n  label: PropTypes.node,\n  /** The `ProgressBar` style variant to use. */\n  variant: PropTypes.oneOf(VARIANTS),\n  /** Specifies an additional `className` to add to the base element. */\n  className: PropTypes.string,\n  /** Threshold current value. */\n  threshold: PropTypes.number,\n  /** Specifies label for `threshold`. */\n  thresholdLabel: PropTypes.node,\n  /** Variant for threshold value. */\n  thresholdVariant: PropTypes.oneOf(VARIANTS),\n  /** Text near the progress annotation. */\n  progressHint: PropTypes.node,\n  /** Text near the threshold annotation. */\n  thresholdHint: PropTypes.node,\n};\n\nProgressBarAnnotated.defaultProps = {\n  now: undefined,\n  label: undefined,\n  variant: PROGRESS_DEFAULT_VARIANT,\n  className: undefined,\n  threshold: undefined,\n  thresholdLabel: undefined,\n  thresholdVariant: THRESHOLD_DEFAULT_VARIANT,\n  progressHint: undefined,\n  thresholdHint: undefined,\n};\n\nProgressBar.Annotated = ProgressBarAnnotated;\nexport default ProgressBar;\n"],"mappings":"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"}