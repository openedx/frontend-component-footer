{"version":3,"file":"index.js","names":["React","useLayoutEffect","useState","PropTypes","classNames","POSITION_VARIANTS","Sticky","forwardRef","ref","position","children","offset","className","rest","isSticky","setIsSticky","defaultRef","useRef","resolvedRef","current","stickyElement","elementStyles","window","getComputedStyle","elementOffset","elementWithOffset","parseInt","observer","IntersectionObserver","entry","intersectionRatio","threshold","rootMargin","observe","unobserve","propTypes","node","isRequired","oneOf","oneOfType","number","string","defaultProps","undefined"],"sources":["../../src/Sticky/index.jsx"],"sourcesContent":["import React, { useLayoutEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\n\nconst POSITION_VARIANTS = [\n  'top',\n  'bottom',\n];\n\nconst Sticky = React.forwardRef(({\n  position,\n  children,\n  offset,\n  className,\n  ...rest\n}, ref) => {\n  const [isSticky, setIsSticky] = useState(false);\n  const defaultRef = React.useRef();\n  const resolvedRef = ref || defaultRef;\n\n  // eslint-disable-next-line consistent-return\n  useLayoutEffect(() => {\n    if (resolvedRef.current) {\n      const stickyElement = resolvedRef.current;\n      // getComputedStyle is used to get real top/bottom\n      // values on the page for proper shadows display\n      const elementStyles = window.getComputedStyle(stickyElement);\n      const elementOffset = elementStyles[position || 'top'];\n      // Margin calculations according to the offset.\n      // 1 pixel above/bellow + offset pixels that determines\n      // when callback function is called\n      const elementWithOffset = 1 + (parseInt(elementOffset, 10) || 0);\n      const observer = new IntersectionObserver(\n        ([entry]) => setIsSticky(entry.intersectionRatio < 1),\n        {\n          threshold: [1],\n          rootMargin: position === 'bottom'\n            ? `0px 0px -${elementWithOffset}px 0px`\n            : `-${elementWithOffset}px 0px 0px 0px`,\n        },\n      );\n      observer.observe(stickyElement);\n\n      return () => {\n        observer.unobserve(stickyElement);\n      };\n    }\n  }, [position, resolvedRef]);\n\n  return (\n    <div\n      className={classNames(\n        'pgn__sticky',\n        `pgn__sticky-${position || 'top'}`,\n        offset ? `pgn__sticky-offset--${offset}` : '',\n        { 'pgn__sticky-shadow': isSticky },\n        className,\n      )}\n      ref={resolvedRef}\n      {...rest}\n    >\n      {children}\n    </div>\n  );\n});\n\nSticky.propTypes = {\n  /** Specifies content of the component. */\n  children: PropTypes.node.isRequired,\n  /** Specifies position of the element. */\n  position: PropTypes.oneOf(POSITION_VARIANTS),\n  /**\n   * Specifies offset from top/bottom depending on the `position` property.\n   *\n   * Valid values are based on `the spacing classes`:\n   * `0, 0.5, ... 6`.\n   */\n  offset: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  /** Specifies an additional `className` to add to the base element. */\n  className: PropTypes.string,\n};\n\nSticky.defaultProps = {\n  position: 'top',\n  offset: undefined,\n  className: undefined,\n};\n\nexport default Sticky;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,eAAhB,EAAiCC,QAAjC,QAAiD,OAAjD;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA,IAAMC,iBAAiB,GAAG,CACxB,KADwB,EAExB,QAFwB,CAA1B;AAKA,IAAMC,MAAM,gBAAGN,KAAK,CAACO,UAAN,CAAiB,gBAM7BC,GAN6B,EAMrB;EAAA,IALTC,QAKS,QALTA,QAKS;EAAA,IAJTC,QAIS,QAJTA,QAIS;EAAA,IAHTC,MAGS,QAHTA,MAGS;EAAA,IAFTC,SAES,QAFTA,SAES;EAAA,IADNC,IACM;;EACT,gBAAgCX,QAAQ,CAAC,KAAD,CAAxC;EAAA;EAAA,IAAOY,QAAP;EAAA,IAAiBC,WAAjB;;EACA,IAAMC,UAAU,GAAGhB,KAAK,CAACiB,MAAN,EAAnB;EACA,IAAMC,WAAW,GAAGV,GAAG,IAAIQ,UAA3B,CAHS,CAKT;;EACAf,eAAe,CAAC,YAAM;IACpB,IAAIiB,WAAW,CAACC,OAAhB,EAAyB;MACvB,IAAMC,aAAa,GAAGF,WAAW,CAACC,OAAlC,CADuB,CAEvB;MACA;;MACA,IAAME,aAAa,GAAGC,MAAM,CAACC,gBAAP,CAAwBH,aAAxB,CAAtB;MACA,IAAMI,aAAa,GAAGH,aAAa,CAACZ,QAAQ,IAAI,KAAb,CAAnC,CALuB,CAMvB;MACA;MACA;;MACA,IAAMgB,iBAAiB,GAAG,KAAKC,QAAQ,CAACF,aAAD,EAAgB,EAAhB,CAAR,IAA+B,CAApC,CAA1B;MACA,IAAMG,QAAQ,GAAG,IAAIC,oBAAJ,CACf;QAAA;QAAA,IAAEC,KAAF;;QAAA,OAAad,WAAW,CAACc,KAAK,CAACC,iBAAN,GAA0B,CAA3B,CAAxB;MAAA,CADe,EAEf;QACEC,SAAS,EAAE,CAAC,CAAD,CADb;QAEEC,UAAU,EAAEvB,QAAQ,KAAK,QAAb,sBACIgB,iBADJ,yBAEJA,iBAFI;MAFd,CAFe,CAAjB;MASAE,QAAQ,CAACM,OAAT,CAAiBb,aAAjB;MAEA,OAAO,YAAM;QACXO,QAAQ,CAACO,SAAT,CAAmBd,aAAnB;MACD,CAFD;IAGD;EACF,CA1Bc,EA0BZ,CAACX,QAAD,EAAWS,WAAX,CA1BY,CAAf;EA4BA,oBACE;IACE,SAAS,EAAEd,UAAU,CACnB,aADmB,wBAEJK,QAAQ,IAAI,KAFR,GAGnBE,MAAM,iCAA0BA,MAA1B,IAAqC,EAHxB,EAInB;MAAE,sBAAsBG;IAAxB,CAJmB,EAKnBF,SALmB,CADvB;IAQE,GAAG,EAAEM;EARP,GASML,IATN,GAWGH,QAXH,CADF;AAeD,CAvDc,CAAf;AAyDAJ,MAAM,CAAC6B,SAAP,GAAmB;EACjB;EACAzB,QAAQ,EAAEP,SAAS,CAACiC,IAAV,CAAeC,UAFR;;EAGjB;EACA5B,QAAQ,EAAEN,SAAS,CAACmC,KAAV,CAAgBjC,iBAAhB,CAJO;;EAKjB;AACF;AACA;AACA;AACA;AACA;EACEM,MAAM,EAAER,SAAS,CAACoC,SAAV,CAAoB,CAACpC,SAAS,CAACqC,MAAX,EAAmBrC,SAAS,CAACsC,MAA7B,CAApB,CAXS;;EAYjB;EACA7B,SAAS,EAAET,SAAS,CAACsC;AAbJ,CAAnB;AAgBAnC,MAAM,CAACoC,YAAP,GAAsB;EACpBjC,QAAQ,EAAE,KADU;EAEpBE,MAAM,EAAEgC,SAFY;EAGpB/B,SAAS,EAAE+B;AAHS,CAAtB;AAMA,eAAerC,MAAf"}