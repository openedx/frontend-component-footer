{"version":3,"file":"index.js","names":["React","useEffect","useMemo","useRef","BaseTabs","classNames","PropTypes","TabsDeprecated","Bubble","Dropdown","useIndexOfLastVisibleChild","Tab","MORE_TAB_TEXT","Tabs","children","className","moreTabText","defaultActiveKey","activeKey","props","containerElementRef","overflowElementRef","indexOfLastVisibleChild","current","parentNode","observer","MutationObserver","mutations","forEach","mutation","eventKey","target","getAttribute","isActive","element","querySelector","moreTab","classList","add","remove","observe","attributes","subtree","attributeFilter","disconnect","undefined","tabIndex","handleDropdownTabClick","hiddenTab","click","tabsChildren","indexOfOverflowStart","childrenList","Children","map","child","index","isValidElement","title","notification","tabClassName","rest","newTitle","tabClass","modifiedTab","cloneElement","moreTabHasNotification","overflowChildren","slice","overflowChild","disabled","active","splice","length","propTypes","node","isRequired","string","defaultProps","Deprecated","default","TabContainer","TabContent","TabPane"],"sources":["../../src/Tabs/index.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef } from 'react';\nimport BaseTabs from 'react-bootstrap/Tabs';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport TabsDeprecated from './deprecated';\nimport Bubble from '../Bubble';\nimport Dropdown from '../Dropdown';\nimport useIndexOfLastVisibleChild from '../hooks/useIndexOfLastVisibleChild';\nimport Tab from './Tab';\n\nexport const MORE_TAB_TEXT = 'More...';\n\nconst Tabs = ({\n  children,\n  className,\n  moreTabText = MORE_TAB_TEXT,\n  defaultActiveKey,\n  activeKey,\n  ...props\n}) => {\n  const containerElementRef = useRef(null);\n  const overflowElementRef = useRef(null);\n  const indexOfLastVisibleChild = useIndexOfLastVisibleChild(\n    containerElementRef.current?.children[0],\n    overflowElementRef.current?.parentNode,\n  );\n\n  useEffect(() => {\n    if (containerElementRef.current) {\n      const observer = new MutationObserver((mutations => {\n        mutations.forEach(mutation => {\n          // React-Bootstrap attribute 'data-rb-event-key' is responsible for the tab identification\n          const eventKey = mutation.target.getAttribute('data-rb-event-key');\n          // React-Bootstrap attribute 'aria-selected' is responsible for selected/unselected state\n          const isActive = mutation.target.getAttribute('aria-selected') === 'true';\n          // datakey attribute is added manually to the dropdown\n          // elements so that they correspond to the native tabs' eventKey\n          const element = containerElementRef.current.querySelector(`[datakey='${eventKey}']`);\n          const moreTab = containerElementRef.current.querySelector('.pgn__tab_more');\n          if (isActive) {\n            element?.classList.add('active');\n            // Here we add active class to the 'More Tab' if element exists in the dropdown\n            if (element) {\n              moreTab.classList.add('active');\n            } else {\n              moreTab.classList.remove('active');\n            }\n          } else {\n            element?.classList.remove('active');\n          }\n        });\n      }));\n      observer.observe(containerElementRef.current, {\n        attributes: true, subtree: true, attributeFilter: ['aria-selected'],\n      });\n      return () => observer.disconnect();\n    }\n    return undefined;\n  }, []);\n\n  useEffect(() => {\n    if (overflowElementRef.current?.parentNode) {\n      overflowElementRef.current.parentNode.tabIndex = -1;\n    }\n  }, [overflowElementRef.current?.parentNode]);\n\n  const handleDropdownTabClick = (eventKey) => {\n    const hiddenTab = containerElementRef.current.querySelector(`[data-rb-event-key='${eventKey}']`);\n    hiddenTab.click();\n  };\n\n  const tabsChildren = useMemo(() => {\n    const indexOfOverflowStart = indexOfLastVisibleChild + 1;\n    const childrenList = React.Children.map(children, (child, index) => {\n      if (!React.isValidElement(child)) {\n        return child;\n      }\n      const {\n        title, notification, tabClassName, ...rest\n      } = child.props;\n      let newTitle;\n      if (notification) {\n        newTitle = (\n          <>\n            {title}\n            <Bubble variant=\"error\" className=\"pgn__tab-notification\">{notification}</Bubble>\n          </>\n        );\n      } else {\n        newTitle = title;\n      }\n      const tabClass = index > indexOfLastVisibleChild ? 'pgn__tab_invisible' : '';\n      const modifiedTab = React.cloneElement(child, {\n        ...rest,\n        title: newTitle,\n        tabClassName: classNames(tabClass, tabClassName),\n      });\n      return modifiedTab;\n    });\n    let moreTabHasNotification = false;\n    const overflowChildren = childrenList.slice(indexOfOverflowStart)\n      .map(overflowChild => {\n        if (!moreTabHasNotification && overflowChild.props.notification) {\n          moreTabHasNotification = true;\n        }\n        return (\n          <Dropdown.Item\n            key={`${overflowChild.props.eventKey}overflow`}\n            onClick={() => handleDropdownTabClick(overflowChild.props.eventKey)}\n            disabled={overflowChild.props.disabled}\n            datakey={overflowChild.props.eventKey}\n            className={classNames({\n              active: overflowChild.props.eventKey === defaultActiveKey || overflowChild.props.eventKey === activeKey,\n            }, 'pgn__tabs__dropdown-item')}\n          >\n            {overflowChild.props.title}\n          </Dropdown.Item>\n        );\n      });\n\n    childrenList.splice(indexOfOverflowStart, 0, (\n      <Tab\n        key=\"moreTabKey\"\n        tabClassName={classNames(!overflowChildren.length && 'pgn__tab_invisible', 'pgn__tab_more')}\n        title={(\n          <Dropdown ref={overflowElementRef}>\n            <Dropdown.Toggle\n              variant=\"link\"\n              className=\"nav-link\"\n              id=\"pgn__tab-toggle\"\n            >\n              {moreTabText}\n              {moreTabHasNotification && (\n                <Bubble variant=\"error\" className=\"pgn__tab-notification\" />\n              )}\n            </Dropdown.Toggle>\n            <Dropdown.Menu className=\"dropdown-menu-right\">{overflowChildren}</Dropdown.Menu>\n          </Dropdown>\n        )}\n      />\n    ));\n    return childrenList;\n  }, [activeKey, children, defaultActiveKey, indexOfLastVisibleChild, moreTabText]);\n\n  return (\n    <div ref={containerElementRef}>\n      <BaseTabs\n        defaultActiveKey={defaultActiveKey}\n        activeKey={activeKey}\n        {...props}\n        className={classNames(className, 'pgn__tabs')}\n      >\n        {tabsChildren}\n      </BaseTabs>\n    </div>\n  );\n};\n\nTabs.propTypes = {\n  /** Specifies elements that is processed to create tabs. */\n  children: PropTypes.node.isRequired,\n  /** Specifies class name to append to the base element. */\n  className: PropTypes.string,\n  /** Specifies text for the 'More' tab. */\n  moreTabText: PropTypes.string,\n  /** Specifies default active tab (uncontrolled usage). */\n  defaultActiveKey: PropTypes.string,\n  /** Specifies active tab (controlled usage). */\n  activeKey: PropTypes.string,\n};\n\nTabs.defaultProps = {\n  className: undefined,\n  moreTabText: MORE_TAB_TEXT,\n  defaultActiveKey: undefined,\n  activeKey: undefined,\n};\n\nTabs.Deprecated = TabsDeprecated;\n\nexport default Tabs;\nexport { Tab };\nexport { default as TabContainer } from 'react-bootstrap/TabContainer';\nexport { default as TabContent } from 'react-bootstrap/TabContent';\nexport { default as TabPane } from 'react-bootstrap/TabPane';\n"],"mappings":"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"}